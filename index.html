<!DOCTYPE html>
<html lang="th">
<head>
Â  Â <meta charset="UTF-8">
Â  Â <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â <title>Personal AI Dashboard</title>
Â  Â <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’¡</text></svg>">
Â  Â <style>
Â  Â  Â  Â @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap');
Â  Â  Â  Â :root {
Â  Â  Â  Â  Â  Â --dark-bg: #0d1117;
Â  Â  Â  Â  Â  Â --medium-bg: #161b22;
Â  Â  Â  Â  Â  Â --light-bg: #1c2128;
Â  Â  Â  Â  Â  Â --border-color: #30363d;
Â  Â  Â  Â  Â  Â --text-primary: #c9d1d9;
Â  Â  Â  Â  Â  Â --text-secondary: #8b949e;
Â  Â  Â  Â  Â  Â --accent-blue: #58a6ff;
Â  Â  Â  Â  Â  Â --accent-green: #238636;
Â  Â  Â  Â  Â  Â --accent-red: #da3633;
Â  Â  Â  Â  Â  Â --accent-orange: #f0883e;
Â  Â  Â  Â  Â  Â --accent-purple: #a371f7;
Â  Â  Â  Â }
Â  Â  Â  Â body { font-family: 'Sarabun', sans-serif; background-color: var(--dark-bg); color: var(--text-primary); margin: 0; padding: 20px; }
Â  Â  Â  Â .container { width: 100%; max-width: 900px; margin: auto; }
Â  Â  Â  Â .header { text-align: center; padding: 20px 0; position: relative; }
Â  Â  Â  Â .header h1 { margin: 0; font-size: 28px; }

Â  Â  Â  Â /* ğŸ” Auto-refresh indicator */
Â  Â  Â  Â .auto-refresh-indicator {
Â  Â  Â  Â  Â  Â position: absolute;
Â  Â  Â  Â  Â  Â top: 20px;
Â  Â  Â  Â  Â  Â right: 0;
Â  Â  Â  Â  Â  Â display: flex;
Â  Â  Â  Â  Â  Â align-items: center;
Â  Â  Â  Â  Â  Â gap: 8px;
Â  Â  Â  Â  Â  Â font-size: 12px;
Â  Â  Â  Â  Â  Â color: var(--text-secondary);
Â  Â  Â  Â  Â  Â background-color: var(--medium-bg);
Â  Â  Â  Â  Â  Â padding: 6px 12px;
Â  Â  Â  Â  Â  Â border-radius: 6px;
Â  Â  Â  Â  Â  Â border: 1px solid var(--border-color);
Â  Â  Â  Â }
Â  Â  Â  Â .refresh-dot {
Â  Â  Â  Â  Â  Â width: 8px;
Â  Â  Â  Â  Â  Â height: 8px;
Â  Â  Â  Â  Â  Â background-color: var(--accent-green);
Â  Â  Â  Â  Â  Â border-radius: 50%;
Â  Â  Â  Â  Â  Â animation: pulse 2s infinite;
Â  Â  Â  Â }
Â  Â  Â  Â @keyframes pulse {
Â  Â  Â  Â  Â  Â 0% { opacity: 1; }
Â  Â  Â  Â  Â  Â 50% { opacity: 0.5; }
Â  Â  Â  Â  Â  Â 100% { opacity: 1; }
Â  Â  Â  Â }

Â  Â  Â  Â .wallet-info { display: flex; justify-content: space-between; align-items: center; padding: 15px; background-color: var(--medium-bg); border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 20px; flex-wrap: wrap; }
Â  Â  Â  Â .wallet-details { display: flex; align-items: center; gap: 10px; }
Â  Â  Â  Â #walletAddress { font-family: monospace; }
Â  Â  Â  Â #networkName { background-color: var(--border-color); padding: 4px 8px; border-radius: 6px; font-size: 12px; font-weight: 700; border: 1px solid #4d545e; }
Â  Â  Â  Â #connectButton { background-color: var(--accent-green); color: white; border: none; padding: 10px 18px; border-radius: 6px; cursor: pointer; font-weight: 700; transition: background-color 0.2s; margin-top: 10px; width: 100%; }
Â  Â  Â  Â #connectButton:hover { background-color: #2ea043; }
Â  Â  Â  Â @media (min-width: 600px) { #connectButton { width: auto; margin-top: 0; } }

Â  Â  Â  Â .section { background-color: var(--medium-bg); border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 20px; overflow: hidden; }
Â  Â  Â  Â .section-header { padding: 15px 20px; background-color: var(--light-bg); border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
Â  Â  Â  Â .section-header h2 { margin: 0; font-size: 20px; }
Â  Â  Â  Â .section-content { padding: 20px; }

Â  Â  Â  Â /* ğŸ”„ Cache indicator */
Â  Â  Â  Â .cache-indicator {
Â  Â  Â  Â  Â  Â font-size: 11px;
Â  Â  Â  Â  Â  Â padding: 3px 8px;
Â  Â  Â  Â  Â  Â border-radius: 4px;
Â  Â  Â  Â  Â  Â background-color: rgba(88, 166, 255, 0.2);
Â  Â  Â  Â  Â  Â color: var(--accent-blue);
Â  Â  Â  Â  Â  Â border: 1px solid rgba(88, 166, 255, 0.3);
Â  Â  Â  Â }
Â  Â  Â  Â .cache-indicator.cached {
Â  Â  Â  Â  Â  Â background-color: rgba(35, 134, 54, 0.2);
Â  Â  Â  Â  Â  Â color: var(--accent-green);
Â  Â  Â  Â  Â  Â border-color: rgba(35, 134, 54, 0.3);
Â  Â  Â  Â }

Â  Â  Â  Â .loading-state, .error-state { text-align: center; color: var(--text-secondary); padding: 40px 20px; }
Â  Â  Â  Â .loader { border: 4px solid var(--border-color); border-top: 4px solid var(--accent-blue); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto 15px auto; }
Â  Â  Â  Â @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

Â  Â  Â  Â .token-list { list-style-type: none; padding: 0; margin: 0; }
Â  Â  Â  Â .token-item { display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-color); }
Â  Â  Â  Â .token-item:last-child { border-bottom: none; }
Â  Â  Â  Â .token-icon { width: 36px; height: 36px; margin-right: 15px; border-radius: 50%; background-color: var(--dark-bg);}
Â  Â  Â  Â .token-info { flex-grow: 1; }
Â  Â  Â  Â .token-symbol { font-weight: 700; }
Â  Â  Â  Â .token-name { font-size: 12px; color: var(--text-secondary); }
Â  Â  Â  Â .token-balance { text-align: right; font-weight: 700; font-size: 1.1em; }
Â  Â  Â  Â .token-value { font-size: 12px; color: var(--text-secondary); text-align: right; }

Â  Â  Â  Â /* ğŸ“Š Chart container */
Â  Â  Â  Â .chart-container {
Â  Â  Â  Â  Â  Â margin-top: 20px;
Â  Â  Â  Â  Â  Â background-color: var(--dark-bg);
Â  Â  Â  Â  Â  Â border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â border-radius: 6px;
Â  Â  Â  Â  Â  Â padding: 15px;
Â  Â  Â  Â  Â  Â height: 200px;
Â  Â  Â  Â  Â  Â position: relative;
Â  Â  Â  Â }
Â  Â  Â  Â .chart-loading {
Â  Â  Â  Â  Â  Â position: absolute;
Â  Â  Â  Â  Â  Â top: 50%;
Â  Â  Â  Â  Â  Â left: 50%;
Â  Â  Â  Â  Â  Â transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â color: var(--text-secondary);
Â  Â  Â  Â }
Â  Â  Â  Â .price-chart {
Â  Â  Â  Â  Â  Â width: 100%;
Â  Â  Â  Â  Â  Â height: 100%;
Â  Â  Â  Â }

Â  Â  Â  Â .ai-analysis-container { margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px; }
Â  Â  Â  Â .ai-analysis-item { padding: 15px; background-color: rgba(88, 166, 255, 0.1); border-left: 3px solid var(--accent-blue); border-radius: 0 6px 6px 0; margin-bottom: 10px; }
Â  Â  Â  Â .ai-analysis-item.quota-error { background-color: rgba(240, 136, 62, 0.1); border-left-color: var(--accent-orange); }
Â  Â  Â  Â .ai-analysis-item.portfolio-health { background-color: rgba(163, 113, 247, 0.1); border-left-color: var(--accent-purple); }
Â  Â  Â  Â .ai-analysis-item:last-child { margin-bottom: 0; }
Â  Â  Â  Â .ai-title { font-weight: 700; color: var(--accent-blue); display: block; margin-bottom: 5px; font-size: 14px; }
Â  Â  Â  Â .quota-error .ai-title { color: var(--accent-orange); }
Â  Â  Â  Â .portfolio-health .ai-title { color: var(--accent-purple); }
Â  Â  Â  Â .ai-content { margin: 0; line-height: 1.6; }
Â  Â  Â  Â .ai-value { font-weight: 700; color: var(--text-primary); font-size: 1.2em; }

Â  Â  Â  Â /* ğŸ†• Features panel */
Â  Â  Â  Â .features-panel {
Â  Â  Â  Â  Â  Â display: flex;
Â  Â  Â  Â  Â  Â gap: 10px;
Â  Â  Â  Â  Â  Â padding: 10px;
Â  Â  Â  Â  Â  Â background-color: var(--light-bg);
Â  Â  Â  Â  Â  Â border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â border-radius: 6px;
Â  Â  Â  Â  Â  Â margin-bottom: 20px;
Â  Â  Â  Â  Â  Â flex-wrap: wrap;
Â  Â  Â  Â  Â  Â font-size: 12px;
Â  Â  Â  Â }
Â  Â  Â  Â .feature-badge {
Â  Â  Â  Â  Â  Â display: flex;
Â  Â  Â  Â  Â  Â align-items: center;
Â  Â  Â  Â  Â  Â gap: 5px;
Â  Â  Â  Â  Â  Â padding: 4px 10px;
Â  Â  Â  Â  Â  Â background-color: var(--medium-bg);
Â  Â  Â  Â  Â  Â border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â border-radius: 4px;
Â  Â  Â  Â  Â  Â color: var(--text-secondary);
Â  Â  Â  Â }
Â  Â  Â  Â .feature-badge.active {
Â  Â  Â  Â  Â  Â border-color: var(--accent-green);
Â  Â  Â  Â  Â  Â color: var(--accent-green);
Â  Â  Â  Â }
Â  Â  Â  Â .feature-icon {
Â  Â  Â  Â  Â  Â font-size: 14px;
Â  Â  Â  Â }

Â  Â  Â  Â .status-panel { display: flex; justify-content: space-between; flex-wrap: wrap; padding: 10px; margin-top: 20px; font-size: 12px; color: var(--text-secondary); }
Â  Â  Â  Â .status-item { display: flex; align-items: center; gap: 6px; margin-bottom: 5px; width: 50%; justify-content: flex-start; }
Â  Â  Â  Â @media (min-width: 600px) { .status-item { width: auto; } }

Â  Â  Â  Â .debug-log-container { margin-top: 20px; background-color: var(--medium-bg); border: 1px solid var(--border-color); border-radius: 8px; font-family: monospace; font-size: 12px; }
Â  Â  Â  Â .debug-log-header { padding: 10px 15px; background-color: var(--light-bg); border-bottom: 1px solid var(--border-color); font-weight: 700; display: flex; justify-content: space-between; align-items: center; }
Â  Â  Â  Â .debug-log-content { padding: 15px; height: 200px; overflow-y: auto; background-color: var(--dark-bg); color: var(--text-secondary); }
Â  Â  Â  Â .log-entry { margin-bottom: 5px; word-break: break-all; }
Â  Â  Â  Â .log-success { color: #3fb950; }
Â  Â  Â  Â .log-error { color: #f85149; }
Â  Â  Â  Â .log-info { color: #a371f7; }
Â  Â  Â  Â .log-warning { color: #f0883e; }
Â  Â  Â  Â .clear-log-btn {
Â  Â  Â  Â  Â  Â font-size: 11px;
Â  Â  Â  Â  Â  Â background-color: var(--accent-red);
Â  Â  Â  Â  Â  Â color: white;
Â  Â  Â  Â  Â  Â border: none;
Â  Â  Â  Â  Â  Â padding: 4px 10px;
Â  Â  Â  Â  Â  Â border-radius: 4px;
Â  Â  Â  Â  Â  Â cursor: pointer;
Â  Â  Â  Â }
Â  Â  Â  Â .clear-log-btn:hover { background-color: #f85149; }
Â  Â </style>
</head>
<body>
Â  Â <div class="container">
Â  Â  Â  Â <header class="header">
Â  Â  Â  Â  Â  Â <h1>Personal AI Dashboard</h1>
Â  Â  Â  Â  Â  Â <div class="auto-refresh-indicator" id="autoRefreshIndicator" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â <div class="refresh-dot"></div>
Â  Â  Â  Â  Â  Â  Â  Â <span>Auto-refresh: <span id="refreshCountdown">30</span>s</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â </header>
Â  Â  Â  Â 
Â  Â  Â  Â Â  Â  Â  Â <div class="features-panel">
Â  Â  Â  Â  Â  Â <div class="feature-badge" id="cacheFeature">
Â  Â  Â  Â  Â  Â  Â  Â <span class="feature-icon">ğŸ”„</span>
Â  Â  Â  Â  Â  Â  Â  Â <span>Cache System</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="feature-badge" id="autoRefreshFeature">
Â  Â  Â  Â  Â  Â  Â  Â <span class="feature-icon">ğŸ”</span>
Â  Â  Â  Â  Â  Â  Â  Â <span>Auto-refresh</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="feature-badge" id="priceHistoryFeature">
Â  Â  Â  Â  Â  Â  Â  Â <span class="feature-icon">ğŸ“Š</span>
Â  Â  Â  Â  Â  Â  Â  Â <span>Price History</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="feature-badge" id="multiTokenFeature">
Â  Â  Â  Â  Â  Â  Â  Â <span class="feature-icon">ğŸª™</span>
Â  Â  Â  Â  Â  Â  Â  Â <span>Multi-token</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â </div>
Â  Â  Â  Â 
Â  Â  Â  Â <div class="wallet-info">
Â  Â  Â  Â  Â  Â <div class="wallet-details">
Â  Â  Â  Â  Â  Â  Â  Â <span id="networkName"></span>
Â  Â  Â  Â  Â  Â  Â  Â <span id="walletAddress">à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­</span>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <button id="connectButton">à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Wallet</button>
Â  Â  Â  Â </div>
Â  Â  Â  Â 
Â  Â  Â  Â <div id="dashboardContent">
Â  Â  Â  Â  Â  Â Â  Â  Â  Â  Â  Â <section class="section">
Â  Â  Â  Â  Â  Â  Â  Â <div class="section-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <h2>à¹‚à¸—à¹€à¸„à¹‡à¸™à¸«à¸¥à¸±à¸ (Native Token)</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="cache-indicator" id="cacheIndicator" style="display: none;">à¸ˆà¸²à¸ Cache</span>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â <div class="section-content" id="mainTokenSection">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="loading-state">à¹‚à¸›à¸£à¸”à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Wallet...</div>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â </section>
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â Â  Â  Â  Â  Â  Â <section class="section" id="erc20Section" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â <div class="section-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <h2>ERC-20 Tokens</h2>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â <div class="section-content" id="erc20TokensContent">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="loading-state">à¸à¸³à¸¥à¸±à¸‡à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ tokens...</div>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â </section>
Â  Â  Â  Â </div>
Â  Â  Â  Â 
Â  Â  Â  Â <div class="status-panel" id="systemStatus">
Â  Â  Â  Â  Â  Â <div class="status-item">Backend: <span id="status-Backend"></span></div>
Â  Â  Â  Â  Â  Â <div class="status-item">Alchemy: <span id="status-Alchemy"></span></div>
Â  Â  Â  Â  Â  Â <div class="status-item">Gemini AI: <span id="status-GeminiAI"></span></div>
Â  Â  Â  Â  Â  Â <div class="status-item">Cache: <span id="status-CacheSystem"></span></div>
Â  Â  Â  Â  Â  Â <div class="status-item">Netlify: <span id="status-Netlify"></span></div>
Â  Â  Â  Â  Â  Â <div class="status-item">Browser: <span id="status-Browser"></span></div>
Â  Â  Â  Â </div>
Â  Â  Â  Â 
Â  Â  Â  Â <div class="debug-log-container" id="debugLog" style="display: none;">
Â  Â  Â  Â  Â  Â <div class="debug-log-header">
Â  Â  Â  Â  Â  Â  Â  Â à¸šà¸±à¸™à¸—à¸¶à¸à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™ (Debug Log)
Â  Â  Â  Â  Â  Â  Â  Â <button class="clear-log-btn" onclick="clearDebugLog()">Clear</button>
Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â <div class="debug-log-content" id="debugLogContent"></div>
Â  Â  Â  Â </div>
Â  Â </div>

Â  Â <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  Â <script>
Â  Â  Â  Â // Global variables
Â  Â  Â  Â const connectButton = document.getElementById('connectButton');
Â  Â  Â  Â const walletAddressSpan = document.getElementById('walletAddress');
Â  Â  Â  Â const networkNameSpan = document.getElementById('networkName');
Â  Â  Â  Â const mainTokenSection = document.getElementById('mainTokenSection');
Â  Â  Â  Â const erc20Section = document.getElementById('erc20Section');
Â  Â  Â  Â const erc20TokensContent = document.getElementById('erc20TokensContent');
Â  Â  Â  Â const debugLogContainer = document.getElementById('debugLog');
Â  Â  Â  Â const debugLogContent = document.getElementById('debugLogContent');
Â  Â  Â  Â const autoRefreshIndicator = document.getElementById('autoRefreshIndicator');
Â  Â  Â  Â const refreshCountdown = document.getElementById('refreshCountdown');
Â  Â  Â  Â const cacheIndicator = document.getElementById('cacheIndicator');
Â  Â  Â  Â 
Â  Â  Â  Â const BACKEND_URL = "https://838de3bd-02e7-4ba3-8bf0-63ab0412b36f-00-39zqf2mohnweu.pike.replit.dev";
Â  Â  Â  Â let currentAccount = null;
Â  Â  Â  Â let autoRefreshInterval = null;
Â  Â  Â  Â let countdownInterval = null;
Â  Â  Â  Â let priceChart = null;
Â  Â  Â  Â let refreshTimeLeft = 30;

Â  Â  Â  Â // Debug logging functions
Â  Â  Â  Â function clearDebugLog() {Â 
Â  Â  Â  Â  Â  Â debugLogContent.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â debugLogContainer.style.display = 'none';Â 
Â  Â  Â  Â }
Â  Â  Â  Â 
Â  Â  Â  Â function logDebug(message, type = 'info') {Â 
Â  Â  Â  Â  Â  Â debugLogContainer.style.display = 'block';Â 
Â  Â  Â  Â  Â  Â const entry = document.createElement('div');Â 
Â  Â  Â  Â  Â  Â entry.className = `log-entry log-${type}`;Â 
Â  Â  Â  Â  Â  Â entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;Â 
Â  Â  Â  Â  Â  Â debugLogContent.appendChild(entry);Â 
Â  Â  Â  Â  Â  Â debugLogContent.scrollTop = debugLogContent.scrollHeight;Â 
Â  Â  Â  Â }

Â  Â  Â  Â // ğŸ” Auto-refresh functions
Â  Â  Â  Â function startAutoRefresh() {
Â  Â  Â  Â  Â  Â logDebug('ğŸ” [Auto-refresh] à¹€à¸£à¸´à¹ˆà¸¡à¸£à¸°à¸šà¸š auto-refresh (à¸—à¸¸à¸ 30 à¸§à¸´à¸™à¸²à¸—à¸µ)', 'info');
Â  Â  Â  Â  Â  Â autoRefreshIndicator.style.display = 'flex';
Â  Â  Â  Â  Â  Â document.getElementById('autoRefreshFeature').classList.add('active');
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // Countdown timer
Â  Â  Â  Â  Â  Â refreshTimeLeft = 30;
Â  Â  Â  Â  Â  Â countdownInterval = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â refreshTimeLeft--;
Â  Â  Â  Â  Â  Â  Â  Â refreshCountdown.textContent = refreshTimeLeft;
Â  Â  Â  Â  Â  Â  Â  Â if (refreshTimeLeft <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â refreshTimeLeft = 30;
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â }, 1000);
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // Auto refresh interval
Â  Â  Â  Â  Â  Â autoRefreshInterval = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â if (currentAccount) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ” [Auto-refresh] à¸à¸³à¸¥à¸±à¸‡ refresh à¸‚à¹‰à¸­à¸¡à¸¹à¸¥...', 'info');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â fetchFullDashboard(currentAccount);
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â }, 30000); // 30 seconds
Â  Â  Â  Â }

Â  Â  Â  Â function stopAutoRefresh() {
Â  Â  Â  Â  Â  Â if (autoRefreshInterval) {
Â  Â  Â  Â  Â  Â  Â  Â clearInterval(autoRefreshInterval);
Â  Â  Â  Â  Â  Â  Â  Â clearInterval(countdownInterval);
Â  Â  Â  Â  Â  Â  Â  Â autoRefreshInterval = null;
Â  Â  Â  Â  Â  Â  Â  Â countdownInterval = null;
Â  Â  Â  Â  Â  Â  Â  Â autoRefreshIndicator.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('autoRefreshFeature').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ” [Auto-refresh] à¸«à¸¢à¸¸à¸”à¸£à¸°à¸šà¸š auto-refresh', 'warning');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â // ğŸ“Š Price chart functions
Â  Â  Â  Â async function loadPriceHistory(token) {
Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸ“Š [Price History] à¸à¸³à¸¥à¸±à¸‡à¸”à¸¶à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸£à¸²à¸„à¸² ${token}...`);
Â  Â  Â  Â  Â  Â  Â  Â const response = await fetch(`${BACKEND_URL}/api/price_history/${token}`);
Â  Â  Â  Â  Â  Â  Â  Â const data = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â if (data.success && data.history) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸ“Š [Price History] à¹„à¸”à¹‰à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ ${data.history.length} à¸£à¸²à¸¢à¸à¸²à¸£`, 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â renderPriceChart(data.history);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('priceHistoryFeature').classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ“Š [Price History] à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸£à¸²à¸„à¸²', 'warning');
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸ“Š [Price History] Error: ${error.message}`, 'error');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â function renderPriceChart(history) {
Â  Â  Â  Â  Â  Â const chartHtml = `
Â  Â  Â  Â  Â  Â  Â  Â <div class="chart-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <canvas id="priceChart" class="price-chart"></canvas>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // Add chart to main token section
Â  Â  Â  Â  Â  Â const existingChart = document.querySelector('.chart-container');
Â  Â  Â  Â  Â  Â if (existingChart) {
Â  Â  Â  Â  Â  Â  Â  Â existingChart.remove();
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â mainTokenSection.insertAdjacentHTML('beforeend', chartHtml);
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â const ctx = document.getElementById('priceChart').getContext('2d');
Â  Â  Â  Â  Â  Â const labels = history.map(item => {
Â  Â  Â  Â  Â  Â  Â  Â const date = new Date(item.timestamp);
Â  Â  Â  Â  Â  Â  Â  Â return date.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â const prices = history.map(item => item.price);
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â if (priceChart) {
Â  Â  Â  Â  Â  Â  Â  Â priceChart.destroy();
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â priceChart = new Chart(ctx, {
Â  Â  Â  Â  Â  Â  Â  Â type: 'line',
Â  Â  Â  Â  Â  Â  Â  Â data: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â labels: labels,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â label: 'à¸£à¸²à¸„à¸² MATIC (USD)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â data: prices,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â borderColor: '#58a6ff',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â backgroundColor: 'rgba(88, 166, 255, 0.1)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â borderWidth: 2,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â tension: 0.4,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â pointRadius: 0,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â pointHoverRadius: 4
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }]
Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â options: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â responsive: true,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â maintainAspectRatio: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â plugins: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â legend: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â display: false
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â tooltip: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â mode: 'index',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â intersect: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â backgroundColor: '#1c2128',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â titleColor: '#c9d1d9',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â bodyColor: '#8b949e',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â borderColor: '#30363d',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â borderWidth: 1,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â padding: 10,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â displayColors: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â callbacks: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â label: function(context) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return `$${context.parsed.y.toFixed(4)}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â scales: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â grid: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â color: '#30363d',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â drawBorder: false
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ticks: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â color: '#8b949e',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â maxTicksLimit: 6
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â y: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â grid: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â color: '#30363d',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â drawBorder: false
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ticks: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â color: '#8b949e',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â callback: function(value) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return '$' + value.toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â interaction: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â mode: 'nearest',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â axis: 'x',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â intersect: false
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â }

Â  Â  Â  Â // Main dashboard fetch function
Â  Â  Â  Â async function fetchFullDashboard(address) {
Â  Â  Â  Â  Â  Â clearDebugLog();
Â  Â  Â  Â  Â  Â logDebug('ğŸš€ à¹€à¸£à¸´à¹ˆà¸¡à¸à¸£à¸°à¸šà¸§à¸™à¸à¸²à¸£...');
Â  Â  Â  Â  Â  Â renderLoading(mainTokenSection);

Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â logDebug('1. [Frontend] à¸à¸³à¸¥à¸±à¸‡à¸ªà¹ˆà¸‡à¸„à¸³à¸‚à¸­à¹„à¸›à¸¢à¸±à¸‡ Backend...');
Â  Â  Â  Â  Â  Â  Â  Â const response = await fetch(`${BACKEND_URL}/api/get_full_dashboard?address=${address}`);
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`2. [Frontend] à¹„à¸”à¹‰à¸£à¸±à¸šà¸à¸²à¸£à¸•à¸­à¸šà¸à¸¥à¸±à¸šà¸ˆà¸²à¸ Backend (à¸ªà¸–à¸²à¸™à¸°: ${response.status})`);

Â  Â  Â  Â  Â  Â  Â  Â const data = await response.json();

Â  Â  Â  Â  Â  Â  Â  Â if (response.status === 429 && data.reason === 'QUOTA_EXCEEDED') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`âŒ ${data.details}`, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â renderQuotaError(data);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â  Â  Â if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const errorMessage = `Backend à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§à¸—à¸µà¹ˆà¸‚à¸±à¹‰à¸™à¸•à¸­à¸™: "${data.failed_at}". à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”: ${data.details}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â throw new Error(errorMessage);
Â  Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â  Â  Â // Log backend processes
Â  Â  Â  Â  Â  Â  Â  Â logDebug('3. [Backend] à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Alchemy à¸ªà¸³à¹€à¸£à¹‡à¸ˆ');
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // ğŸ”„ Cache info
Â  Â  Â  Â  Â  Â  Â  Â if (data.cache_info && data.cache_info.price_cached) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`4. [Backend] à¹ƒà¸Šà¹‰à¸£à¸²à¸„à¸²à¸ˆà¸²à¸ Cache (à¸­à¸²à¸¢à¸¸: ${data.cache_info.cache_age}s)`, 'info');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cacheIndicator.style.display = 'inline-block';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cacheIndicator.classList.add('cached');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('cacheFeature').classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('4. [Backend] à¸”à¸¶à¸‡à¸£à¸²à¸„à¸²à¹ƒà¸«à¸¡à¹ˆà¸ˆà¸²à¸ CoinGecko', 'info');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â cacheIndicator.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // ğŸª™ Multi-token info
Â  Â  Â  Â  Â  Â  Â  Â if (data.erc20_tokens && data.erc20_tokens.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`5. [Backend] à¸à¸š ${data.erc20_tokens.length} ERC-20 tokens`, 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('multiTokenFeature').classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â renderERC20Tokens(data.erc20_tokens);
Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('5. [Backend] à¹„à¸¡à¹ˆà¸à¸š ERC-20 tokens', 'warning');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â erc20Section.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â logDebug('6. [Backend] à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹‚à¸”à¸¢ Gemini AI à¸ªà¸³à¹€à¸£à¹‡à¸ˆ');
Â  Â  Â  Â  Â  Â  Â  Â logDebug('7. [Frontend] à¸à¸³à¸¥à¸±à¸‡à¹à¸ªà¸”à¸‡à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥...');

Â  Â  Â  Â  Â  Â  Â  Â // Render main token
Â  Â  Â  Â  Â  Â  Â  Â renderMainToken(data.matic);
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // ğŸ“Š Load price history
Â  Â  Â  Â  Â  Â  Â  Â loadPriceHistory('matic');
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Update feature badges
Â  Â  Â  Â  Â  Â  Â  Â if (data.features) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â updateFeatureBadges(data.features);
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â logDebug('âœ… à¸à¸£à¸°à¸šà¸§à¸™à¸à¸²à¸£à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ!', 'success');

Â  Â  Â  Â  Â  Â  Â  Â // Start auto-refresh if not already started
Â  Â  Â  Â  Â  Â  Â  Â if (!autoRefreshInterval && currentAccount) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â startAutoRefresh();
Â  Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â console.error('Could not fetch dashboard data:', error);
Â  Â  Â  Â  Â  Â  Â  Â renderError(mainTokenSection, `à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”`);
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`âŒ ${error.message}`, 'error');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â function updateFeatureBadges(features) {
Â  Â  Â  Â  Â  Â if (features.cache_enabled) {
Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('cacheFeature').classList.add('active');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â if (features.auto_refresh_enabled) {
Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('autoRefreshFeature').classList.add('active');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â if (features.price_history_enabled) {
Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('priceHistoryFeature').classList.add('active');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â if (features.multi_token_enabled) {
Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('multiTokenFeature').classList.add('active');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â // ğŸª™ Render ERC-20 tokens
Â  Â  Â  Â function renderERC20Tokens(tokens) {
Â  Â  Â  Â  Â  Â if (!tokens || tokens.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â erc20Section.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â erc20Section.style.display = 'block';
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â // For now, show basic token info
Â  Â  Â  Â  Â  Â // In real implementation, you would fetch token metadata
Â  Â  Â  Â  Â  Â const tokenListHtml = `
Â  Â  Â  Â  Â  Â  Â  Â <ul class="token-list">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ${tokens.map((token, index) => `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <li class="token-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <img src="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸª™</text></svg>" class="token-icon">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="token-info">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="token-symbol">Token ${index + 1}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="token-name">${token.contractAddress.substring(0, 10)}...</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="token-balance">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>Balance: ${token.balance.substring(0, 10)}...</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="token-value">Loading price...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `).join('')}
Â  Â  Â  Â  Â  Â  Â  Â </ul>
Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â erc20TokensContent.innerHTML = tokenListHtml;
Â  Â  Â  Â  Â  Â logDebug(`ğŸª™ [Multi-token] à¹à¸ªà¸”à¸‡ ${tokens.length} tokens`, 'success');
Â  Â  Â  Â }

Â  Â  Â  Â function renderQuotaError(errorData) {
Â  Â  Â  Â  Â  Â mainTokenSection.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-item quota-error">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="ai-title">à¸à¸¥à¸±à¸‡à¸›à¸±à¸à¸à¸²à¸–à¸¹à¸à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹€à¸•à¹‡à¸¡à¸à¸´à¸à¸±à¸”à¹à¸¥à¹‰à¸§ ğŸ”‹</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="ai-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â à¹‚à¸„à¸§à¸•à¹‰à¸²à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ AI à¸ªà¸³à¸«à¸£à¸±à¸šà¸§à¸±à¸™à¸™à¸µà¹‰à¹€à¸•à¹‡à¸¡à¹à¸¥à¹‰à¸§à¸„à¸£à¸±à¸š
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â à¸£à¸°à¸šà¸šà¸ˆà¸°à¸à¸¥à¸±à¸šà¸¡à¸²à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¹ƒà¸™à¸§à¸±à¸™à¸à¸£à¸¸à¹ˆà¸‡à¸™à¸µà¹‰
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â à¸‚à¸­à¸­à¸ à¸±à¸¢à¹ƒà¸™à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸ªà¸°à¸”à¸§à¸à¸„à¸£à¸±à¸š
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â }

Â  Â  Â  Â async function checkSystemStatus() {
Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â const response = await fetch(`${BACKEND_URL}/api/health_check`);
Â  Â  Â  Â  Â  Â  Â  Â if (!response.ok) throw new Error('Health check failed');
Â  Â  Â  Â  Â  Â  Â  Â const status = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Update main status indicators
Â  Â  Â  Â  Â  Â  Â  Â for (const service in status) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (status.hasOwnProperty(service) && typeof status[service] === 'string') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â updateStatusIndicator(service, status[service]);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Log feature status
Â  Â  Â  Â  Â  Â  Â  Â if (status.Features) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ”§ [System] Features status:', 'info');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â for (const feature in status.Features) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`Â  Â - ${feature}: ${status.Features[feature]}`, 'info');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â console.error("Could not check system status:", error);
Â  Â  Â  Â  Â  Â  Â  Â const services = ["Backend", "Alchemy", "Gemini AI", "CacheSystem", "Netlify", "Browser"];
Â  Â  Â  Â  Â  Â  Â  Â services.forEach(service => updateStatusIndicator(service, 'à¹„à¸¡à¹ˆà¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­'));
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â function updateStatusIndicator(service, status) {
Â  Â  Â  Â  Â  Â const indicator = document.getElementById(`status-${service.replace(' ', '')}`);
Â  Â  Â  Â  Â  Â if (indicator) {
Â  Â  Â  Â  Â  Â  Â  Â indicator.textContent = status;
Â  Â  Â  Â  Â  Â  Â  Â if (status === "à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¹‰à¸§" || status === "à¸—à¸³à¸‡à¸²à¸™à¸›à¸à¸•à¸´") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â indicator.style.color = 'var(--accent-green)';
Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â indicator.style.color = 'var(--accent-red)';
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â // Initialize on DOM load
Â  Â  Â  Â document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â checkSystemStatus();
Â  Â  Â  Â  Â  Â // Check system status every 60 seconds
Â  Â  Â  Â  Â  Â setInterval(checkSystemStatus, 60000);
Â  Â  Â  Â });

Â  Â  Â  Â // Connect wallet button
Â  Â  Â  Â connectButton.addEventListener('click', async () => {
Â  Â  Â  Â  Â  Â if (typeof window.ethereum !== 'undefined') {
Â  Â  Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â handleAccountsChanged(accounts);
Â  Â  Â  Â  Â  Â  Â  Â } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â console.error("User rejected request:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug('âŒ à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸›à¸à¸´à¹€à¸ªà¸˜à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ wallet', 'error');
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â alert('à¹‚à¸›à¸£à¸”à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ MetaMask!');
Â  Â  Â  Â  Â  Â  Â  Â logDebug('âŒ à¹„à¸¡à¹ˆà¸à¸š MetaMask à¹ƒà¸™à¹€à¸šà¸£à¸²à¸§à¹Œà¹€à¸‹à¸­à¸£à¹Œ', 'error');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â });

Â  Â  Â  Â // MetaMask event listeners
Â  Â  Â  Â if (typeof window.ethereum !== 'undefined') {
Â  Â  Â  Â  Â  Â window.ethereum.on('accountsChanged', handleAccountsChanged);
Â  Â  Â  Â  Â  Â window.ethereum.on('chainChanged', () => {
Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ”„ à¹€à¸„à¸£à¸·à¸­à¸‚à¹ˆà¸²à¸¢à¸¡à¸µà¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡ à¸à¸³à¸¥à¸±à¸‡ reload à¸«à¸™à¹‰à¸²...', 'warning');
Â  Â  Â  Â  Â  Â  Â  Â window.location.reload();
Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â }

Â  Â  Â  Â function getNetworkName(chainId) {
Â  Â  Â  Â  Â  Â const networks = {Â 
Â  Â  Â  Â  Â  Â  Â  Â '0x89': 'Polygon',Â 
Â  Â  Â  Â  Â  Â  Â  Â '0x1': 'Ethereum',Â 
Â  Â  Â  Â  Â  Â  Â  Â '0x38': 'BNB Chain',Â 
Â  Â  Â  Â  Â  Â  Â  Â '0xa4b1': 'Arbitrum'Â 
Â  Â  Â  Â  Â  Â };
Â  Â  Â  Â  Â  Â return networks[chainId] || 'Unknown';
Â  Â  Â  Â }

Â  Â  Â  Â async function handleAccountsChanged(accounts) {
Â  Â  Â  Â  Â  Â if (accounts.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â // Disconnected
Â  Â  Â  Â  Â  Â  Â  Â currentAccount = null;
Â  Â  Â  Â  Â  Â  Â  Â walletAddressSpan.textContent = 'à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­';
Â  Â  Â  Â  Â  Â  Â  Â networkNameSpan.textContent = '';
Â  Â  Â  Â  Â  Â  Â  Â connectButton.textContent = 'à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Wallet';
Â  Â  Â  Â  Â  Â  Â  Â mainTokenSection.innerHTML = '<div class="loading-state">à¹‚à¸›à¸£à¸”à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Wallet...</div>';
Â  Â  Â  Â  Â  Â  Â  Â erc20Section.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â clearDebugLog();
Â  Â  Â  Â  Â  Â  Â  Â stopAutoRefresh();
Â  Â  Â  Â  Â  Â } else if (accounts[0] !== currentAccount) {
Â  Â  Â  Â  Â  Â  Â  Â // Account changed
Â  Â  Â  Â  Â  Â  Â  Â currentAccount = accounts[0];
Â  Â  Â  Â  Â  Â  Â  Â walletAddressSpan.textContent = `${currentAccount.substring(0, 6)}...${currentAccount.substring(currentAccount.length - 4)}`;
Â  Â  Â  Â  Â  Â  Â  Â connectButton.textContent = 'à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¹‰à¸§';
Â  Â  Â  Â  Â  Â  Â  Â const chainId = await window.ethereum.request({ method: 'eth_chainId' });
Â  Â  Â  Â  Â  Â  Â  Â networkNameSpan.textContent = getNetworkName(chainId);
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸ”— à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ wallet: ${currentAccount}`, 'success');
Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸŒ à¹€à¸„à¸£à¸·à¸­à¸‚à¹ˆà¸²à¸¢: ${getNetworkName(chainId)}`, 'info');
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Stop existing auto-refresh before starting new one
Â  Â  Â  Â  Â  Â  Â  Â stopAutoRefresh();
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Fetch dashboard data
Â  Â  Â  Â  Â  Â  Â  Â fetchFullDashboard(currentAccount);
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â function renderLoading(sectionElement, text = "à¸à¸³à¸¥à¸±à¸‡à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ...") {
Â  Â  Â  Â  Â  Â sectionElement.innerHTML = `<div class="loading-state"><div class="loader"></div><p>${text}</p></div>`;
Â  Â  Â  Â }

Â  Â  Â  Â function renderError(sectionElement, message) {
Â  Â  Â  Â  Â  Â sectionElement.innerHTML = `<div class="error-state">${message}</div>`;
Â  Â  Â  Â }

Â  Â  Â  Â function renderMainToken(tokenData) {
Â  Â  Â  Â  Â  Â if (tokenData && tokenData.data && tokenData.data.symbol) {
Â  Â  Â  Â  Â  Â  Â  Â const analysis = tokenData.analysis || {};
Â  Â  Â  Â  Â  Â  Â  Â const estimatedValue = parseFloat(analysis.estimated_usd || 0).toLocaleString('en-US', {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â style: 'currency',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â currency: 'USD'Â 
Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â let aiAnalysisHtml = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="ai-title">à¸¡à¸¹à¸¥à¸„à¹ˆà¸²à¹‚à¸”à¸¢à¸›à¸£à¸°à¸¡à¸²à¸“</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="ai-content ai-value">${estimatedValue}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="ai-title">ğŸ§  à¸šà¸—à¸ªà¸£à¸¸à¸›à¸ˆà¸²à¸ AI</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="ai-content">${analysis.summary || 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="ai-title">ğŸ’¡ à¹€à¸à¸£à¹‡à¸”à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰ (Pro Tip)</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="ai-content">${analysis.pro_tip || 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â // Add portfolio health if available
Â  Â  Â  Â  Â  Â  Â  Â if (analysis.portfolio_health) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â aiAnalysisHtml += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="ai-analysis-item portfolio-health">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="ai-title">ğŸ“ˆ à¸ªà¸¸à¸‚à¸ à¸²à¸ Portfolio</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="ai-content">${analysis.portfolio_health}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â aiAnalysisHtml += '</div>';
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â mainTokenSection.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <ul class="token-list">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <li class="token-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <img src="${tokenData.data.icon}"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸª™</text></svg>'"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="token-icon">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="token-info">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="token-symbol">${tokenData.data.symbol}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="token-name">${tokenData.data.name}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="token-balance">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span>${tokenData.data.balance}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </ul>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ${aiAnalysisHtml}
Â  Â  Â  Â  Â  Â  Â  Â `;
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â logDebug('âœ… à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Native Token à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢', 'success');
Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â renderError(mainTokenSection, 'à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹‚à¸—à¹€à¸„à¹‡à¸™à¸«à¸¥à¸±à¸à¹„à¸”à¹‰');
Â  Â  Â  Â  Â  Â  Â  Â logDebug('âŒ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ token à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡', 'error');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â // Auto-refresh config check
Â  Â  Â  Â async function checkAutoRefreshConfig() {
Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â const response = await fetch(`${BACKEND_URL}/api/auto_refresh_config`);
Â  Â  Â  Â  Â  Â  Â  Â const config = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â if (config.enabled) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â logDebug(`ğŸ” [Config] Auto-refresh enabled (interval: ${config.interval}s)`, 'info');
Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â logDebug('ğŸ” [Config] à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡ auto-refresh config', 'warning');
Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â }

Â  Â  Â  Â // Initial config check
Â  Â  Â  Â checkAutoRefreshConfig();
Â  Â </script>
</body>
</html>
